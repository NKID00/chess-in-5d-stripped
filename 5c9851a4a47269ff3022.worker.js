/*! For license information please see 5c9851a4a47269ff3022.worker.js.LICENSE.txt */
!function(r){var t={};function e(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"===typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var o in r)e.d(n,o,function(t){return r[t]}.bind(null,o));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="./",e(e.s=2)}([function(r,t,e){var n=e(7);r.exports=function(r,t){if(r){if("string"===typeof r)return n(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?n(r,t):void 0}}},function(r,t,e){(function(t){var n=e(4),o=e(9),a=e(10),i=e(11);r.exports=function(){var r;return function(){function r(t,e,n){function o(i,s){if(!e[i]){if(!t[i]){if(a)return a(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=e[i]={exports:{}};t[i][0].call(l.exports,(function(r){return o(t[i][1][r]||r)}),l,l.exports,r,t,e,n)}return e[i].exports}for(var a=!1,i=0;i<n.length;i++)o(n[i]);return o}return r}()({1:[function(t,e,n){!function(t){"use strict";function n(r,t){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}function o(r,t){return r<<t|r>>>32-t}function a(r,t,e,a,i,s){return n(o(n(n(t,r),n(a,s)),i),e)}function i(r,t,e,n,o,i,s){return a(t&e|~t&n,r,t,o,i,s)}function s(r,t,e,n,o,i,s){return a(t&n|e&~n,r,t,o,i,s)}function c(r,t,e,n,o,i,s){return a(t^e^n,r,t,o,i,s)}function l(r,t,e,n,o,i,s){return a(e^(t|~n),r,t,o,i,s)}function h(r,t){var e,o,a,h,u;r[t>>5]|=128<<t%32,r[14+(t+64>>>9<<4)]=t;var f=1732584193,v=-271733879,d=-1732584194,g=271733878;for(e=0;e<r.length;e+=16)o=f,a=v,h=d,u=g,f=i(f,v,d,g,r[e],7,-680876936),g=i(g,f,v,d,r[e+1],12,-389564586),d=i(d,g,f,v,r[e+2],17,606105819),v=i(v,d,g,f,r[e+3],22,-1044525330),f=i(f,v,d,g,r[e+4],7,-176418897),g=i(g,f,v,d,r[e+5],12,1200080426),d=i(d,g,f,v,r[e+6],17,-1473231341),v=i(v,d,g,f,r[e+7],22,-45705983),f=i(f,v,d,g,r[e+8],7,1770035416),g=i(g,f,v,d,r[e+9],12,-1958414417),d=i(d,g,f,v,r[e+10],17,-42063),v=i(v,d,g,f,r[e+11],22,-1990404162),f=i(f,v,d,g,r[e+12],7,1804603682),g=i(g,f,v,d,r[e+13],12,-40341101),d=i(d,g,f,v,r[e+14],17,-1502002290),f=s(f,v=i(v,d,g,f,r[e+15],22,1236535329),d,g,r[e+1],5,-165796510),g=s(g,f,v,d,r[e+6],9,-1069501632),d=s(d,g,f,v,r[e+11],14,643717713),v=s(v,d,g,f,r[e],20,-373897302),f=s(f,v,d,g,r[e+5],5,-701558691),g=s(g,f,v,d,r[e+10],9,38016083),d=s(d,g,f,v,r[e+15],14,-660478335),v=s(v,d,g,f,r[e+4],20,-405537848),f=s(f,v,d,g,r[e+9],5,568446438),g=s(g,f,v,d,r[e+14],9,-1019803690),d=s(d,g,f,v,r[e+3],14,-187363961),v=s(v,d,g,f,r[e+8],20,1163531501),f=s(f,v,d,g,r[e+13],5,-1444681467),g=s(g,f,v,d,r[e+2],9,-51403784),d=s(d,g,f,v,r[e+7],14,1735328473),f=c(f,v=s(v,d,g,f,r[e+12],20,-1926607734),d,g,r[e+5],4,-378558),g=c(g,f,v,d,r[e+8],11,-2022574463),d=c(d,g,f,v,r[e+11],16,1839030562),v=c(v,d,g,f,r[e+14],23,-35309556),f=c(f,v,d,g,r[e+1],4,-1530992060),g=c(g,f,v,d,r[e+4],11,1272893353),d=c(d,g,f,v,r[e+7],16,-155497632),v=c(v,d,g,f,r[e+10],23,-1094730640),f=c(f,v,d,g,r[e+13],4,681279174),g=c(g,f,v,d,r[e],11,-358537222),d=c(d,g,f,v,r[e+3],16,-722521979),v=c(v,d,g,f,r[e+6],23,76029189),f=c(f,v,d,g,r[e+9],4,-640364487),g=c(g,f,v,d,r[e+12],11,-421815835),d=c(d,g,f,v,r[e+15],16,530742520),f=l(f,v=c(v,d,g,f,r[e+2],23,-995338651),d,g,r[e],6,-198630844),g=l(g,f,v,d,r[e+7],10,1126891415),d=l(d,g,f,v,r[e+14],15,-1416354905),v=l(v,d,g,f,r[e+5],21,-57434055),f=l(f,v,d,g,r[e+12],6,1700485571),g=l(g,f,v,d,r[e+3],10,-1894986606),d=l(d,g,f,v,r[e+10],15,-1051523),v=l(v,d,g,f,r[e+1],21,-2054922799),f=l(f,v,d,g,r[e+8],6,1873313359),g=l(g,f,v,d,r[e+15],10,-30611744),d=l(d,g,f,v,r[e+6],15,-1560198380),v=l(v,d,g,f,r[e+13],21,1309151649),f=l(f,v,d,g,r[e+4],6,-145523070),g=l(g,f,v,d,r[e+11],10,-1120210379),d=l(d,g,f,v,r[e+2],15,718787259),v=l(v,d,g,f,r[e+9],21,-343485551),f=n(f,o),v=n(v,a),d=n(d,h),g=n(g,u);return[f,v,d,g]}function u(r){var t,e="",n=32*r.length;for(t=0;t<n;t+=8)e+=String.fromCharCode(r[t>>5]>>>t%32&255);return e}function f(r){var t,e=[];for(e[(r.length>>2)-1]=void 0,t=0;t<e.length;t+=1)e[t]=0;var n=8*r.length;for(t=0;t<n;t+=8)e[t>>5]|=(255&r.charCodeAt(t/8))<<t%32;return e}function v(r){return u(h(f(r),8*r.length))}function d(r,t){var e,n,o=f(r),a=[],i=[];for(a[15]=i[15]=void 0,o.length>16&&(o=h(o,8*r.length)),e=0;e<16;e+=1)a[e]=909522486^o[e],i[e]=1549556828^o[e];return n=h(a.concat(f(t)),512+8*t.length),u(h(i.concat(n),640))}function g(r){var t,e,n="0123456789abcdef",o="";for(e=0;e<r.length;e+=1)t=r.charCodeAt(e),o+=n.charAt(t>>>4&15)+n.charAt(15&t);return o}function p(r){return unescape(encodeURIComponent(r))}function y(r){return v(p(r))}function m(r){return g(y(r))}function w(r,t){return d(p(r),p(t))}function b(r,t){return g(w(r,t))}function A(r,t,e){return t?e?w(t,r):b(t,r):e?y(r):m(r)}"function"===typeof r&&r.amd?r((function(){return A})):"object"===typeof e&&e.exports?e.exports=A:t.md5=A}(this)},{}],2:[function(r,t,e){},{}],3:[function(r,e,n){(function(r){(function(){var t=r.performance||{},n=function(){for(var r=["now","webkitNow","msNow","mozNow","oNow"];r.length;){var e=r.shift();if(e in t)return t[e].bind(t)}var n=Date.now||function(){return(new Date).getTime()},o=(t.timing||{}).navigationStart||n();return function(){return n()-o}}();n.performanceNow=t.now,n.noConflict=function(){t.now=n.performanceNow},n.conflict=function(){t.now=n},n.conflict(),e.exports=n}).call(this)}).call(this,"undefined"!==typeof t?t:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],4:[function(r,t,e){var n=this,o=r("./board");e.actions=function(r,t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return function r(t,c){for(var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],v=o.moves(t,c,e,a,s),d=[],g=0;g<v.length;g++){var p=o.copy(t);if(!i||i&&(n.newTimelineIsActive(p,c)||!n.newTimelineIsActive(p,c)&&o.positionIsLatest(p,v[g][1])))if(o.move(p,v[g]),h++,o.present(p,c).length>0){f[l]=g;var y=r(p,c,l+1,h,u,f),m=y[0];h=y[1],u=y[2]>l?y[2]:l,f=y[3];for(var w=0;w<m.length;w++){for(var b=[v[g]],A=0;A<m[w].length;A++)b.push(m[w][A]);d.push(b)}0===m.length&&d.push([v[g]])}else d.push([v[g]])}return[d,h,u,f]}(r,t)[0]},e.move=function(r,t){var e,n=i(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;o.move(r,a)}}catch(s){n.e(s)}finally{n.f()}},e.newTimelineIsActive=function(r,t){for(var e=0,n=0,o=0;r&&o<r.length;o++)r[o]&&(e<o&&o%2!==0&&(e=o),n<o&&o%2===0&&(n=o));return t%2===0?e+1>=n:e+1<=n},e.databaseHasBoard=function(r,t){for(var e=0;e<t.length;e++)if(0==o.compare(r,t[e]))return!0;return t.push(o.copy(r)),!1}},{"./board":5}],5:[function(r,t,e){var n=this,o=r("./piece"),a=r("./turn"),s=r("./parse");e.init=function(r){switch(r){case"defended_pawn":return[[[[-8,-10,-4,-6,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-9,-3,-5,-11,-3,-5,-7]]]];case"half_reflected":return[[[[-8,-6,-4,-10,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-11,-9,-3,-5,-7]]]];case"princess":return[[[[-8,-6,-4,-14,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-13,-11,-3,-5,-7]]]];case"reversed_royalty":return[[[[-8,-6,-4,-20,-18,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-19,-17,-3,-5,-7]]]];case"turn_zero":return[[null,[[-8,-6,-4,-10,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-9,-11,-3,-5,-7]],[[-8,-6,-4,-10,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-9,-11,-3,-5,-7]]]];case"two_timelines":return[null,[[[-8,-6,-4,-10,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-9,-11,-3,-5,-7]]],[[[-8,-6,-4,-10,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-9,-11,-3,-5,-7]]]];case"custom":return[];case"object"===typeof r:return s.toBoard(r);default:return[[[[-8,-6,-4,-10,-12,-4,-6,-8],[-2,-2,-2,-2,-2,-2,-2,-2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1,-1,-1],[-7,-5,-3,-9,-11,-3,-5,-7]]]]}},e.copy=function(r){for(var t=[],e=0;r&&e<r.length;e++){r[e]&&(t[e]=[]);for(var o=0;r[e]&&o<r[e].length;o++){r[e][o]&&(t[e][o]=[]);var i=a.copy(r,e,o);n.setTurn(t,e,o,i)}}return t},e.setTurn=function(r,t,e,n){r=Array.isArray(r)?r:[];for(var o=0;o<=t;o++){if(o==t){r[o]=Array.isArray(r[o])?r[o]:[];for(var a=0;a<=e;a++)a==e&&(r[o][a]=n),a<r[o].length&&"undefined"!=typeof a||(r[o][a]=null)}o<r.length&&"undefined"!=typeof r[o]||(r[o]=null)}},e.move=function(r,t){if(n.positionExists(r,t[0])&&n.positionIsLatest(r,t[0])){var e=t[0],o=t[1],i=a.copy(r,e[0],e[1]),s=o[4]?o[4]:Math.abs(i[e[2]][e[3]]);if(void 0!==s&&0!==s){if(i[e[2]][e[3]]=0,void 0!=o)if(o[0]===e[0]&&o[1]===e[1])i[o[2]][o[3]]=s;else{var c=a.copy(r,o[0],o[1]);if(c[o[2]][o[3]]=s,r[o[0]].length-1===o[1])n.setTurn(r,o[0],o[1]+1,c);else{for(var l=0,h=1;h<r.length;h++)"undefined"!==typeof r[h]&&null!==r[h]&&h%2==o[1]%2&&(l=l<h?h:l);0===l?(r[o[1]%2===0?2:1]=[],n.setTurn(r,o[1]%2===0?2:1,o[1]+1,c)):(r[l+2]=[],n.setTurn(r,l+2,o[1]+1,c))}}n.setTurn(r,e[0],e[1]+1,i)}if(void 0!=t[2]){var u=t[2];if(void 0!=t[3]){var f=t[3],v=f[4]?f[4]:Math.abs(r[u[0]][u[1]][u[2]][u[3]]);void 0!=f&&(r[f[0]][f[1]+1][f[2]][f[3]]=v)}r[u[0]][u[1]+1][u[2]][u[3]]=0}}},e.positionExists=function(r,t){return r[t[0]]&&r[t[0]][t[1]]&&t[2]>=0&&t[2]<r[t[0]][t[1]].length&&t[3]>=0&&t[3]<r[t[0]][t[1]][t[2]].length},e.positionIsLatest=function(r,t){return n.positionExists(r,t)&&r[t[0]].length-1===t[1]},e.active=function(r){for(var t=[],e=0,n=0,o=0;o<r.length;o++)r[o]&&(e=e<o&&o%2!=0?o:e,n=n<o&&o%2==0?o:n);for(var a=0;a<r.length;a++)r[a]&&(n+1>=a&&a%2!=0&&t.push(a),e+3>=a&&a%2==0&&t.push(a));return t},e.present=function(r,t){for(var e=n.active(r),o=[],a=-1,i=0;i<e.length;i++){for(var s=-1,c=0;c<r[e[i]].length;c++)s=r[e[i]][c]&&s<c&&t%2===c%2?c:s;a=-1!=s&&(-1===a||a>s)?s:a}if(a>=0)for(var l=0;l<e.length;l++){for(var h=0,u=0;u<r[e[l]].length;u++)h=r[e[l]][u]&&h<u?u:h;if(a===h&&o.push(e[l]),a>h)return[]}return o},e.moves=function(r,t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3]){var c=n.present(r,t);return n.getMovesFromTimelines(r,c,t,a,i,s)}if(e){var l=n.active(r);return n.getMovesFromTimelines(r,l,t,a,i,s)}for(var h=0;h<r.length;h++){var u=r[h];if(u){var f=u[u.length-1];if((u.length-1)%2===t%2)for(var v=0;f&&v<f.length;v++)for(var d=0;f[v]&&d<f[v].length;d++){var g=Math.abs(f[v][d]);if(0!==g&&g%2===t%2)for(var p=o.moves(r,[h,u.length-1,v,d],a,i),y=0;y<p.length;y++)s.push(p[y])}}}return s},e.positionIsAttacked=function(r,t,e){for(var n=t[2],a=t[3],i=r[t[0]][t[1]],s=o.movePos(6),c=o.moveVecs(10),l=0;l<8;l++){var h=n+s[l][2],u=a+s[l][3];if(!(h<0||h>=i.length||u<0||u>=i[h].length)){var f=Math.abs(i[h][u]);if(0!==f&&f-e===5)return!0}}for(var v=0;v<4;v++){var d=c[v][2],g=c[v][3],p=n+d,y=a+g;if(p>=0&&p<i.length&&y>=0&&y<i[p].length){var m=Math.abs(i[p][y]);if(0!==m){var w=m-e;if(m%2===e)continue;if(w>=7&&w<=13||17===w||19===w)return!0}for(p+=d,y+=g;p>=0&&p<i.length&&y>=0&&y<i[p].length;){if(0!==(m=Math.abs(i[p][y]))){if(m%2!==e){var b=m-e;if(7===b||9===b||13===b||19===b)return!0}break}p+=d,y+=g}}}for(var A=4;A<8;A++){var M=c[A][2],k=c[A][3],B=n+M,C=a+k;if(B>=0&&B<i.length&&C>=0&&C<i[B].length){var P=Math.abs(i[B][C]);if(0!==P){var S=P-e;if(P%2==e)continue;if(5===S||7===S||21===S||23===S)continue;return!0}for(B+=M,C+=k;B>=0&&B<i.length&&C>=0&&C<i[B].length;){if(0!==(P=Math.abs(i[B][C]))){if(P%2!==e){var T=P-e;if(3===T||9===T||13===T||19===T)return!0}break}B+=M,C+=k}}}return!1},e.isTurnZero=function(r){var t=!1;if(!Array.isArray(r)||!r.length>0)return!1;var e,n=i(r);try{for(n.s();!(e=n.n()).done;){var o=e.value;!Array.isArray(o)||o.length<0||Array.isArray(o[0])&&(t=!0)}}catch(a){n.e(a)}finally{n.f()}return!t},e.isEvenTimeline=function(r){return!Array.isArray(r)||!r.length>0||!Array.isArray(r[0])},e.isNormalCastling=function(r){var t=n.isTurnZero(r),e=!1;if(Array.isArray(r)&&r.length>0)return!1;var o,a=i(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(!(Array.isArray(s)&&s.length>0)){var c=s[0];c=t?s[2]:c,Array.isArray(c)&&(-12===c[0][4]&&-11===c[7][4]||(e=!0))}}}catch(l){a.e(l)}finally{a.f()}return!e},e.compare=function(r,t){if(Array.isArray(r)){if(Array.isArray(t)&&r.length===t.length)return-1;for(var e=0;e<fullBoard.length;e++){if(Array.isArray(r[e])){if(!Array.isArray(t[e])||r[e].length!=t[e].length)return-1;for(var n=0;n<r[e].length;n++){if(Array.isArray(r[e][n])){if(!Array.isArray(t[e][n])||r[e][n].length!=t[e][n].length)return-1;for(var o=0;o<r[e][n].length;o++){if(Array.isArray(r[e][n][o])){if(Array.isArray(t[e][n][o])||r[e][n][o].length!=t[e][n][o].length)return-1;for(var a=0;a<r[e][n][o];a++){if(void 0!=r[e][n][o][a]&&void 0!=t[e][n][o][a])return 1;if(void 0!=t[e][n][o][a])return-1;if(r[e][n][o][a]!=t[e][n][o][a])return r[e][n][o][a]-t[e][n][o][a]}}if(Array.isArray(t[e][n][o]))return 1}}if(Array.isArray(t[e][n]))return 1}}if(Array.isArray(t[e]))return 1}}return Array.isArray(t)?1:0},e.getMovesFromTimelines=function(r,t,e,n,a,s){var c,l=i(t);try{for(l.s();!(c=l.n()).done;){var h=c.value;if(r[h]){var u=r[h],f=u[u.length-1];if((u.length-1)%2==e%2)for(var v=0;v<f.length;v++)for(var d=0;d<f[v].length;d++){var g=Math.abs(f[v][d]),p=o.moves(r,[h,u.length-1,v,d],n,a);if(0!=g&&g%2==e%2){var y,m=i(p);try{for(m.s();!(y=m.n()).done;){var w=y.value;s.push(w)}}catch(b){m.e(b)}finally{m.f()}}}}}}catch(b){l.e(b)}finally{l.f()}return s}},{"./parse":13,"./piece":15,"./turn":17}],6:[function(r,t,e){var n=this;r("module-alias/register");var o=r("./board"),a=r("./pgn"),s=r("./parse");r("./validate"),e.board=function(r){var t=r;if("string"===typeof r)try{t=JSON.parse(r)}catch(e){}return Array.isArray(t)?o.copy(t):s.toBoard(t)},e.actions=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=[];if("string"===typeof r){r=r.split("\n").map((function(r){return r.trim()})).filter((function(r){return!r.startsWith("[")&&r})).join("\n").trim();var l=null;try{l=JSON.parse(r)}catch(m){}if(null==l)try{if((l=a.toActionHistory(r,t,e,s)).length<=0&&r.length>0)throw l=null,new Error("No pgn actions found")}catch(m){throw new Error("Notation invalid and an error has occurred with string: "+r)}null!==l&&(r=l)}if(Array.isArray(r)){var h,u=o.copy(t),f=e,v=i(r);try{for(v.s();!(h=v.n()).done;){var d=h.value;c.push(n.action(d,u,f));var g,p=i(d);try{for(p.s();!(g=p.n()).done;){var y=g.value;o.move(u,y)}}catch(m){p.e(m)}finally{p.f()}f++}}catch(m){v.e(m)}finally{v.f()}}return c},e.action=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=o.isTurnZero(t),l=[];if("string"===typeof r){var h=null;try{h=JSON.parse(r)}catch(d){}if(null==h)try{h=a.toAction(r,t,e,n)}catch(d){throw new Error("Notation invalid and an error has occurred with string: "+r)}null!==h&&(r=h)}if(Array.isArray(r)||"object"!=typeof r||(r=r.moves),Array.isArray(r))if(r.length>0&&!Array.isArray(r[0])){var u,f=i(r);try{for(f.s();!(u=f.n()).done;){var v=u.value;l.push(s.toMove(v,c))}}catch(d){f.e(d)}finally{f.f()}}else l=r;return l},e.move=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=o.isTurnZero(t),c=[];if("string"===typeof r){var l=null;try{l=JSON.parse(r)}catch(h){}if(null==l)try{l=a.toMove(r,t,e,[],n)}catch(h){throw new Error("Notation invalid and an error has occurred with string: "+r)}null!==l&&(r=l)}return Array.isArray(r)?c=r:"object"===typeof r&&(c=s.toMove(r,i)),c}},{"./board":5,"./parse":13,"./pgn":14,"./validate":18,"module-alias/register":2}],7:[function(r,t,e){var n=this;e.move=function(r){for(var t=[],e=0;e<r.length;e++)t.push(r[e].slice());return t},e.action=function(r){for(var t=[],e=0;e<r.length;e++)t.push(n.move(r[e]));return t},e.actions=function(r){for(var t=[],e=0;e<r.length;e++)t.push(n.action(r[e]));return t}},{}],8:[function(r,t,e){e.TO_FEN=["","p","P","b","B","n","N","r","R","q","Q","k","K","s","S","w","W","c","C","y","Y","u","U","d","D"],e.FROM_FEN={p:1,P:2,b:3,B:4,n:5,N:6,r:7,R:8,q:9,Q:10,k:11,K:12,s:13,S:14,w:15,W:16,c:17,C:18,y:19,Y:20,u:21,U:22,d:23,D:24},e.OMMIT_UNMOVED=[!0,!1,!1,!0,!0,!0,!0,!1,!1,!0,!0,!1,!1,!0,!0,!1,!1,!0,!0,!0,!0,!0,!0,!0,!0],e.toFen=function(r,t,n){for(var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=0,c="",l=r.length-1;l>=0;l--){var h,u=i(r[l]);try{for(u.s();!(h=u.n()).done;){var f=h.value;if(0==f?s++:s>0&&(c+=s.toString(10),s=0),0!=f){var v=f<0;f=Math.abs(f),e.TO_FEN[f]?c+=e.TO_FEN[f]:c+="?",v&&!e.OMMIT_UNMOVED[f]&&(c+="*")}}}catch(d){u.e(d)}finally{u.f()}s>0&&(c+=s.toString(10),s=0),c+="/"}return c=c.slice(0,-1),c+=":",t%2==1?t=-(t+1)/2:t/=2,c+=a?t>0?"+"+Math.floor(t-1):t<0?"-"+Math.floor(-(t+1)):"0":t>0?"+"+Math.floor(t):t<0?"-"+Math.floor(-t):"0",c+=":",c+=o?Math.floor(n/2):Math.floor(n/2)+1,c+=":","[".concat(c+=n%2?"b":"w","]")},e.fromFen=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"!=typeof r)throw new Error("TypeError: expected argument `raw` to be of type `string`, got: "+typeof r);r.startsWith("[")&&r.endsWith("]")&&(r=r.slice(1,-1));var s=r.split(":");if(4!=s.length)throw new Error("SyntaxError: raw 5DFEN board string doesn't have 4 fields.");var c=s[0].split("/");if(c.length!==n)throw new Error("SyntaxError: the amount of rows isn't equal to the height of the board, did you forget a slash (/) or to set the `size` header?");var l,h=[],u=i(c);try{for(u.s();!(l=u.n()).done;){for(var f=l.value,v=[];f.length;){var d=void 0;if(d=/^\d+/.exec(f)){f=f.slice(d[0].length);for(var g=0;g<+d[0];g++)v.push(0)}else{if(!(d=/^\+?([a-zA-Z])(\*?)/.exec(f)))throw new Error("SyntaxError: unexpected character: '".concat(f[0],"'"));f=f.slice(d[0].length);var p=e.FROM_FEN[d[1]];if(!p)throw new Error("SyntaxError: invalid piece '".concat(d[1],"'"));v.push(d[2]?-p:p)}}if(v.length!=t)throw new Error("SyntaxError: row doesn't have the right width, did you forget a slash (/) or to set the `size` header?");h.push(v)}}catch(A){u.e(A)}finally{u.f()}for(var y=[],m=h.length-1;m>=0;m--)y.push(h[m]);var w="-0"==s[1]||"+0"==s[1]?0:+s[1];if(a&&(w="-0"===s[1]?-1:"+0"===s[1]?1:(w=+s[1])<0?w--:w++),isNaN(w))throw new Error("Invalid FEN timeline: "+s[1]);w<0?w=2*-w-1:w*=2;var b=2*+s[2];if(isNaN(b))throw new Error("Invalid FEN turn: "+s[2]);if(o&&(b+=2),"w"==s[3])b-=2;else{if("b"!=s[3])throw new Error("Invalid FEN color: "+s[3]);b-=1}return[y,w,b]}},{}],9:[function(r,t,e){var n=r("blueimp-md5");e.hash=function(r){var t,e="",o=i(r);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a){var s,c=i(a);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(l){var h,u=0,f=i(l);try{for(f.s();!(h=f.n()).done;){var v,d=h.value,g=i(d);try{for(g.s();!(v=g.n()).done;){var p=v.value;0==p?u++:(u>0&&(e+=""+u,u=0),e+=p>0?String.fromCharCode(97+p):String.fromCharCode(67+Math.abs(p)))}}catch(y){g.e(y)}finally{g.f()}}}catch(y){f.e(y)}finally{f.f()}}else e+="B"}}catch(y){c.e(y)}finally{c.f()}}else e+="A"}}catch(y){o.e(y)}finally{o.f()}return n(e)},e.hashBoard=function(r,t,e){var o=t,a=e,s="";if(r[o][a]){var c,l=0,h=i(r[o][a]);try{for(h.s();!(c=h.n()).done;){var u,f=c.value,v=i(f);try{for(v.s();!(u=v.n()).done;){var d=u.value;0==d?l++:(l>0&&(s+=""+l,l=0),s+=d>0?String.fromCharCode(97+d):String.fromCharCode(67+Math.abs(d)))}}catch(g){v.e(g)}finally{v.f()}}}catch(g){h.e(g)}finally{h.f()}}else s+="B";return n(s)}},{"blueimp-md5":1}],10:[function(r,t,e){r("module-alias/register");var s=r("blueimp-md5"),c=r("./action"),l=r("./board"),h=r("./convert"),u=r("./copy"),f=r("./fen"),v=r("./hash"),d=r("./parse"),g=r("./pgn"),p=r("./piece"),y=r("./print"),m=r("./mate"),w=r("./metadata"),b=r("./turn"),A=r("./validate"),M=function(){"use strict";function r(t,e){o(this,r),this.raw={actionFuncs:c,boardFuncs:l,convertFuncs:h,fenFuncs:f,hashFuncs:v,mateFuncs:m,metadataFuncs:w,parseFuncs:d,pgnFuncs:g,pieceFuncs:p,printFuncs:y,turnFuncs:b,validateFuncs:A},this.checkmateTimeout=6e4,this.skipDetection=!1,this.enableConsole=!1,this.checkmateCache=[],this.metadata={board:"standard",mode:"5D"},this.rawPromotionPieces=[],"undefined"!=typeof t?this.import(t,e):"string"==typeof e?(this.metadata.board=w.lookupVariant(e),this.reset(this.metadata.board)):"object"==typeof e?(this.metadata.board="custom",this.reset(e)):this.reset()}return a(r,[{key:"copy",value:function(){var t=new r;return t.state(this.state()),t}},{key:"state",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==r){var t={};t.checkmateTimeout=this.checkmateTimeout,t.skipDetection=this.skipDetection,t.enableConsole=this.enableConsole,t.checkmateCache=this.checkmateCache.slice(),t.metadata=Object.assign({},this.metadata),t.rawAction=this.rawAction,t.rawStartingAction=this.rawStartingAction,t.rawBoardHistory=[];for(var e=0;e<this.rawBoardHistory.length;e++)t.rawBoardHistory.push(l.copy(this.rawBoardHistory[e]));return t.rawBoard=l.copy(this.rawBoard),t.rawActionHistory=u.actions(this.rawActionHistory),t.rawMoveBuffer=u.action(this.rawMoveBuffer),t.rawPromotionPieces=this.rawPromotionPieces.slice(),t}this.checkmateTimeout=r.checkmateTimeout,this.skipDetection=r.skipDetection,this.enableConsole=r.enableConsole,this.checkmateCache=r.checkmateCache.slice(),this.metadata=Object.assign({},r.metadata),this.rawAction=r.rawAction,this.rawStartingAction=r.rawStartingAction,this.rawBoardHistory=[];for(var n=0;n<r.rawBoardHistory.length;n++)this.rawBoardHistory.push(l.copy(r.rawBoardHistory[n]));this.rawBoard=l.copy(r.rawBoard),this.rawActionHistory=u.actions(r.rawActionHistory),this.rawMoveBuffer=u.action(r.rawMoveBuffer),this.rawPromotionPieces=r.rawPromotionPieces.slice()}},{key:"compare",value:function(r,t){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"board"){case"board":var e=h.board(r),n=h.board(t);return l.compare(e,n);case"move":var o=h.move(r,this.rawBoard,this.rawAction,this.rawPromotionPieces),a=h.move(t,this.rawBoard,this.rawAction,this.rawPromotionPieces);return m.moveCompare(o,a);default:throw new Error("Type not supported, valid types are 'board' and 'move'.")}}},{key:"reset",value:function(r){"string"==typeof r?(this.metadata.board=w.lookupVariant(r),this.rawBoard=l.init(this.metadata.board)):"object"==typeof r?(this.metadata.board="custom",this.rawBoard=l.init(r)):this.rawBoard=l.init(this.metadata.board),this.rawAction=0,"undefined"!=typeof this.rawBoard[0]&&null!=this.rawBoard[0]&&(this.rawAction=this.rawBoard[0].length%2==0?1:0),this.rawStartingAction=this.rawAction,this.rawBoardHistory=[l.copy(this.rawBoard)],this.rawActionHistory=[],this.rawMoveBuffer=[],this.rawPromotionPieces=p.availablePromotionPieces(this.rawBoard)}},{key:"import",value:function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.reset("standard"),"string"==typeof r?(Object.assign(this.metadata,w.strToObj(r)),"string"==typeof this.metadata.board?this.reset(this.metadata.board):this.reset(t)):this.reset(t),this.metadata.promotions){this.rawPromotionPieces=[];var n,o=i(this.metadata.promotions.split(","));try{for(o.s();!(n=o.n()).done;){var a=n.value;this.rawPromotionPieces.push(p.fromChar(a,0)),this.rawPromotionPieces.push(p.fromChar(a,1))}}catch(f){o.e(f)}finally{o.f()}}"custom"==this.metadata.board&&(this.fen(r),"undefined"!==typeof this.rawBoard[0]&&null!==this.rawBoard[0]&&(this.rawAction=this.rawBoard[0].length%2===0?1:0),this.rawStartingAction=this.rawAction,this.rawBoardHistory=[l.copy(this.rawBoard)]);try{for(var s=h.actions(r,this.rawBoardHistory[0],this.rawStartingAction,this.rawPromotionPieces),c=0;c<s.length;c++){for(var u=0;u<s[c].length;u++)this.move(s[c][u]);if(c+1<s.length)this.submit();else try{this.submit()}catch(f){this.enableConsole&&(console.error(f),console.log("Last action is not complete, importing as move buffer."))}}}catch(f){if(this.enableConsole&&(console.error(f),e||console.log("Error importing actions, skipping...")),e)throw f}}},{key:"importable",value:function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{return this.copy().import(r,t,e),!0}catch(n){return!1}}},{key:"fen",value:function(r){if("string"!==typeof r){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){for(var t=l.isTurnZero(this.rawBoard),e=l.isEvenTimeline(this.rawBoard),o="",a=this.rawBoard.length-1;a>0;a--)if(this.rawBoard[a]&&a%2!=0)for(var s=0;s<this.rawBoard[a].length;s++)this.rawBoard[a][s]&&(o+=f.toFen(this.rawBoard[a][s],a,s,t,e)+"\n");for(var c=0;c<this.rawBoard.length;c++)if(this.rawBoard[c]&&c%2==0)for(var h=0;h<this.rawBoard[c].length;h++)this.rawBoard[c][h]&&(o+=f.toFen(this.rawBoard[c][h],c,h,t,e)+"\n");return o}for(var u=this.rawBoardHistory[0],v=l.isTurnZero(u),d=l.isEvenTimeline(u),g="",p=0;p<u.length;p++)for(var y=0;u[p]&&y<u[p].length;y++)u[p][y]&&(g+=f.toFen(u[p][y],p,y,v,d)+"\n");return g}var m,b=8,A=8;Object.assign(this.metadata,w.strToObj(r)),(m=/^(\d+)x(\d+)$/.exec(this.metadata.size||""))&&(b=+m[1],A=+m[2]);var M,k=r.includes("0:b]")||r.includes("0:w]"),B=r.includes(":+0:")||r.includes(":-0:"),C=i(r.replace(/\r\n/g,"\n").replace(/\s*;\s*/g,"\n").split("\n"));try{for(C.s();!(M=C.n()).done;){var P=M.value;if((P=P.trim()).startsWith("[")&&P.endsWith("]")&&!/\s/.exec(P)){var S=f.fromFen(P,b,A,k,B),T=n(S,3),E=T[0],x=T[1],N=T[2];l.setTurn(this.rawBoard,x,N,E)}}}catch(O){C.e(O)}finally{C.f()}}},{key:"fenable",value:function(r){try{return this.copy().fen(r),!0}catch(t){return!1}}},{key:"pass",value:function(){if(!this.skipDetection){if(this.inCheckmate)throw new Error("Cannot submit, currently in checkmate.");if(this.inStalemate)throw new Error("Cannot submit, currently in stalemate.")}m.blankAction(this.rawBoard,this.rawAction),this.submit()}},{key:"passable",value:function(){try{return this.copy().pass(),!0}catch(r){return!1}}},{key:"action",value:function(r){for(var t=h.action(r,this.rawBoard,this.rawAction,this.rawPromotionPieces),e=0;e<t.length;e++)this.move(t[e]);this.submit()}},{key:"actions",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"object",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=l.isTurnZero(this.rawBoard),a=c.actions(this.rawBoard,this.rawAction,t,e,n,this.rawPromotionPieces);if("raw"===r)return a;if(r.includes("notation")||r.includes("5dpgn")){for(var i="",s=0;s<a.length;s++)i+=g.fromMove(a[s],this.rawBoard,this.rawAction,"",r.includes("active"),r.includes("timeline"),r.includes("superphysical"))+"\n";return i}res=[];for(var h=0;h<a.length;h++)(this.skipDetection||this.actionable(a[h]))&&res.push(d.fromAction(this.rawBoard,this.rawAction,a[h],o));return"json"==r?JSON.stringify(res):res}},{key:"actionable",value:function(r){try{return this.copy().action(r),!0}catch(t){return!1}}},{key:"move",value:function(r){var t=h.move(r,this.rawBoard,this.rawAction,this.rawPromotionPieces);if(!this.skipDetection&&!this.moveable(t)){var e="Move is invalid and an error has occurred with this move: "+t;throw this.enableConsole&&console.error(e),new Error(e)}this.rawMoveBuffer.push(t),l.move(this.rawBoard,t)}},{key:"moves",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"object",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=l.isTurnZero(this.rawBoard);if(!this.skipDetection&&(this.inCheckmate||this.inStalemate))return[];var a=l.moves(this.rawBoard,this.rawAction,t,e,n,this.rawPromotionPieces);if("raw"==r)return a;if(r.includes("notation")||r.includes("5dpgn")){var s,c="",h=i(a);try{for(h.s();!(s=h.n()).done;){var u=s.value;c+=g.fromMove(u,this.rawBoard,this.rawAction,"",r.includes("active"),r.includes("timeline"),r.includes("superphysical"))+"\n"}}catch(m){h.e(m)}finally{h.f()}return c}var f,v=[],p=i(a);try{for(p.s();!(f=p.n()).done;){var y=f.value;v.push(d.fromMove(this.rawBoard,y,o))}}catch(m){p.e(m)}finally{p.f()}return"json"==r?JSON.stringify(v):v}},{key:"moveable",value:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{if(this.skipDetection)return!0;var e=h.move(r,this.rawBoard,this.rawAction,this.rawPromotionPieces);return A.move(this.rawBoard,this.rawAction,e,t,this.rawPromotionPieces)}catch(n){return!1}}},{key:"submit",value:function(){if(!this.skipDetection){if(this.inCheckmate)throw new Error("Cannot submit, currently in checkmate.");if(this.inStalemate)throw new Error("Cannot submit, currently in stalemate.");if(this.inCheck)throw new Error("Cannot submit, currently in check.")}if(!this.submittable())throw new Error("Action is not complete, more moves are needed");this.rawBoardHistory.push(l.copy(this.rawBoard)),this.rawActionHistory.push(u.action(this.rawMoveBuffer)),this.rawMoveBuffer=[],this.rawAction++}},{key:"submittable",value:function(){return!(!this.skipDetection&&(this.inCheckmate||this.inStalemate))&&!this.inCheck&&l.present(this.rawBoard,this.rawAction).length<=0}},{key:"undo",value:function(){if(!(this.rawMoveBuffer.length>0))throw new Error("No moves to undo.");var r=u.action(this.rawMoveBuffer);r.pop();for(var t=l.copy(this.rawBoardHistory[this.rawBoardHistory.length-1]),e=0;e<r.length;e++){if(!this.skipDetection&&!A.move(t,this.rawAction,r[e],[],this.rawPromotionPieces)){var n="Undo buffer is corrupted and an error has occurred with this move: "+g.fromMove(r[e],t,this.rawAction);throw this.enableConsole&&console.error(n),new Error(n)}l.move(t,r[e])}this.rawBoard=l.copy(t),this.rawMoveBuffer=u.action(r)}},{key:"undoable",value:function(){try{return this.copy().undo(),!0}catch(r){return!1}}},{key:"checks",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"object",t=l.isTurnZero(this.rawBoard),e=m.checks(this.rawBoard,this.rawAction,!1),n=l.copy(this.rawBoard);if(m.blankAction(n,this.rawAction),"raw"==r)return e;if(r.includes("notation")||r.includes("5dpgn")){var o,a="",s=i(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;a+=g.fromMove(c,n,this.rawAction,r.includes("active"),r.includes("timeline"),r.includes("superphysical"))+"\n"}}catch(p){s.e(p)}finally{s.f()}return a}var h,u=[],f=i(e);try{for(f.s();!(h=f.n()).done;){var v=h.value;u.push(d.fromMove(n,v,t))}}catch(p){f.e(p)}finally{f.f()}return"json"===r?JSON.stringify(u):u}},{key:"inCheckmate",get:function(){var r,t=this.rawBoardHistory[this.rawBoardHistory.length-1],e=v.hash(t),n=i(this.checkmateCache);try{for(n.s();!(r=n.n()).done;)if(e==r.value)return!0}catch(a){n.e(a)}finally{n.f()}var o=m.checkmate(t,this.rawAction,this.checkmateTimeout);return o[0]&&!o[1]&&this.checkmateCache.push(e),o[0]}},{key:"inCheck",get:function(){return m.checks(this.rawBoard,this.rawAction,!0)}},{key:"inStalemate",get:function(){var r=this.rawBoardHistory[this.rawBoardHistory.length-1];return m.stalemate(r,this.rawAction,this.checkmateTimeout)[0]}},{key:"hash",get:function(){return s(this.fen(null,!0).replace(/\n/g,""))}},{key:"export",value:function(){var r=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"5dpgn",e=this.rawBoard,n=l.isTurnZero(e);if("raw"==t)return this.rawActionHistory;if("json"==t)return JSON.stringify(this.rawActionHistory.map((function(t,e){return d.fromAction(r.rawBoardHistory[e],e,t,n)})));if("object"==t)return this.rawActionHistory.map((function(t,e){return d.fromAction(r.rawBoardHistory[e],e,t,n)}));var o=""+w.objToStr(this.metadata);if(t.includes("notation")||t.includes("5dpgn")){"custom"==this.metadata.board&&(o+=this.fen());var a=[];o+=g.fromActionHistory(this.rawActionHistory,this.rawBoardHistory[0],this.rawStartingAction,t.includes("inline")?" ":"\n",a,t.includes("active"),t.includes("timeline"),t.includes("superphysical"))}return o}},{key:"print",value:function(){var r="";r+="Current Player: "+(this.rawAction%2===0?"White":"Black")+"\n",r+="Action Number: "+(Math.ceil(this.rawAction/2)+1)+"\n",this.rawMoveBuffer.length>0&&(r+="Move Stack:\n");var t,e=i(this.rawMoveBuffer);try{for(e.s();!(t=e.n()).done;){var n=t.value;r+="  "+g.fromMove(n,this.rawBoard,this.rawAction)+"\n"}}catch(o){e.e(o)}finally{e.f()}return r+=y.printBoard(this.rawBoard),this.enableConsole&&console.log(r),r}},{key:"print2",value:function(){console.log("Current Player: "+(this.rawAction%2===0?"White":"Black")),console.log("Action Number: "+(Math.ceil(this.rawAction/2)+1)),this.rawMoveBuffer.length>0&&console.log("Move Stack:");var r,t=i(this.rawMoveBuffer);try{for(t.s();!(r=t.n()).done;){var e=r.value;console.log("  "+g.fromMove(e,this.rawBoard,this.rawAction))}}catch(n){t.e(n)}finally{t.f()}console.log(y.printBoard(this.rawBoard))}},{key:"board",get:function(){return d.fromBoard(this.rawBoard,this.rawAction)}},{key:"actionNumber",get:function(){return Math.floor(this.rawAction/2)+1}},{key:"boardHistory",get:function(){for(var r=[],t=0;t<this.rawBoardHistory.length;t++)r.push(d.fromBoard(this.rawBoardHistory[t],t));return r}},{key:"actionHistory",get:function(){return this.export("object")}},{key:"moveBuffer",get:function(){var r,t=l.isTurnZero(this.rawBoard),e=l.copy(this.rawBoardHistory[this.rawBoardHistory.length-1]),n=[],o=i(this.rawMoveBuffer);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.push(d.fromMove(e,a,t)),l.move(e,a)}}catch(s){o.e(s)}finally{o.f()}return n}},{key:"player",get:function(){return this.rawAction%2==0?"white":"black"}},{key:"variants",get:function(){return w.variantDict.map((function(r){return{name:r[0],shortName:r[1]}}))}}]),r}();t.exports=M},{"./action":4,"./board":5,"./convert":6,"./copy":7,"./fen":8,"./hash":9,"./mate":11,"./metadata":12,"./parse":13,"./pgn":14,"./piece":15,"./print":16,"./turn":17,"./validate":18,"blueimp-md5":1,"module-alias/register":2}],11:[function(r,t,e){var n=this,o=r("present"),a=r("./board"),s=r("./turn");e.blankAction=function(r,t){var e,n=a.present(r,t),o=i(n);try{for(o.s();!(e=o.n()).done;){var c=e.value,l=r[c];if(l){var h=s.copy(r,c,l.length-1);(l.length-1)%2==t%2&&(r[c][l.length]=h)}}}catch(u){o.e(u)}finally{o.f()}},e.checks=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=a.copy(r),s=t%2,c=[];n.blankAction(o,t);var l,h=a.moves(o,t+1,!1,!1),u=i(h);try{for(u.s();!(l=u.n()).done;){var f=l.value;if(2===f.length&&a.positionExists(o,f[1])){var v=Math.abs(o[f[1][0]][f[1][1]][f[1][2]][f[1][3]]);if((11==v||12==v||19==v||20==v)&&v%2==s){if(e)return!0;c.push(f)}}}}catch(d){u.e(d)}finally{u.f()}return!e&&c},e.checkmate=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e4;if(!n.checks(r,t,!0))return[!1,!1];var s,c=o(),l=a.moves(r,t,!1,!1),h=i(l);try{for(h.s();!(s=h.n()).done;){var u=s.value,f=a.copy(r);if(a.move(f,u),!n.checks(f,t,!0))return[!1,!1];if(o()-c>e)return[!0,!0]}}catch(b){h.e(b)}finally{h.f()}var v=function r(t,s){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],h=a.moves(t,s,!1,!1);if(l.length<=0&&(l=n.checks(t,s)),l.length<=0)return[!1,!1];if(o()-c>e)return[!0,!0];var u,f=i(h);try{for(f.s();!(u=f.n()).done;){var v=u.value,d=a.copy(t);a.move(d,v);var g=n.checks(d,s);if(g.length<l.length&&!r(d,s,g)[0])return[!1,!1]}}catch(b){f.e(b)}finally{f.f()}return[!0,!1]}(r,t);if(!v[0]||v[1])return v;for(var d=function(r){var t={length:r.length,sig:[]};return r.sort(n.moveCompare),t.sig=r.flat(2),t},g=function(r,t){if(r.checkSig.length!=t.checkSig.length)return r.checkSig.length-t.checkSig.length;if(r.checkSig.sig.length!=t.checkSig.sig.length)return r.checkSig.sig.length-t.checkSig.sig.length;for(var e=0;e<r.checkSig.sig.length;e++)if(r.checkSig.sig[e]!=t.checkSig.sig[e])return r.checkSig.sig[e]-t.checkSig.sig[e];return r.board.length-t.board.length},p=0,y=[{board:r,checkSig:d(n.checks(r,t))}],m=function(){if(o()-c>e)return{v:[!0,!0]};var r=y[p];if(r){var s,l=a.moves(r,t,!1,!1),h=[],u=i(l);try{for(u.s();!(s=u.n()).done;){var f=s.value,v=a.copy(r);a.move(v,f);var m=n.checks(v,t);if(m.length<=0)return{v:[!1,!1]};var w=d(m);h.push({board:v,checkSig:w})}}catch(b){u.e(b)}finally{u.f()}h.sort((function(t,e){return g(r,e)-g(r,t)}));for(var A=0,M=h;A<M.length;A++){var k=M[A];y.push(k)}y.splice(0,1),p--}p++};p<y.length;){var w=m();if("object"===typeof w)return w.v}return[!0,!1]},e.stalemate=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e4,s=n.checks(r,t,!0),c=o(),l=[r];if(s)return[!1,!1];for(;l.length>0;){if(o()-c>e)return[!0,!0];var h=l[0];if(h){var u,f=a.moves(h,t,!1,!1),v=i(f);try{for(v.s();!(u=v.n()).done;){var d=u.value,g=a.copy(h);if(a.move(g,d),!n.checks(g,t,!0)){if(a.present(g,t).length<=0)return[!1,!1];l.push(g)}}}catch(p){v.e(p)}finally{v.f()}}l.splice(0,1)}return[!0,!1]},e.moveCompare=function(r,t){if(Array.isArray(r)){if(!Array.isArray(t))return-1;if(r.length!=t.length)return r.length-t.length;for(var e=0;e<r.length;e++)if(r[e].length==t[e].length){for(var n=0;n<r[e].length;n++)if(r[e][n]!=t[e][n])return r[e][n]-t[e][n];return r[e].length-t[e].length}}return Array.isArray(t)?1:0}},{"./board":5,"./turn":17,present:3}],12:[function(r,t,e){var n=this,o=[["Standard","standard"],["Standard - Defended Pawn","defended_pawn"],["Standard - Half Reflected","half_reflected"],["Standard - Princess","princess"],["Standard - Turn Zero","turn_zero"],["Standard - Two Timelines","two_timelines"],["Standard - Reversed Royalty","reversed_royalty"],["Custom","custom"]];e.strToObj=function(r){var t,e=r.replace(/\r\n/g,"\n").replace(/\]\[/g,"]\n[").split("\n"),o={},a=i(e);try{for(a.s();!(t=a.n()).done;){var s=t.value.match(/\[([^\s]+)\s+\"([^\"]*)\"\]/);if(null!=s){o[s[1].toLowerCase()]=s[2],"board"==s[1].toLowerCase()&&(o[s[1].toLowerCase()]=n.lookupVariant(s[2]));try{var c=JSON.parse(s[2]);o[s[1].toLowerCase()]=c}catch(l){}}}}catch(l){a.e(l)}finally{a.f()}return o},e.objToStr=function(r){for(var t="",e=0,o=Object.keys(r);e<o.length;e++){var a=o[e];"object"===typeof r[a]?t+="["+a.charAt(0).toUpperCase()+a.substr(1)+' "'+JSON.stringify(r[a]).replace(/\"/g,"'")+'"]\n':t+="board"===a?"["+a.charAt(0).toUpperCase()+a.substr(1)+' "'+n.lookupVariantFull(r[a])+'"]\n':"["+a.charAt(0).toUpperCase()+a.substr(1)+' "'+r[a]+'"]\n'}return t},e.lookupVariant=function(r){var t,e=i(o);try{for(e.s();!(t=e.n()).done;){var a=t.value;if(a[0].toLocaleLowerCase().includes(r.toLocaleLowerCase().replace(/_/g," ")))return a[1];if(a[1]==n.lookupVariantFull(r)&&"Standard"!=a[1])return a[1]}}catch(s){e.e(s)}finally{e.f()}return"standard"},e.lookupVariantFull=function(r){var t,e=i(o);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(n[1]==r)return n[0]}}catch(a){e.e(a)}finally{e.f()}return"Standard"},e.variantDict=o},{}],13:[function(r,t,e){var n=this,o=r("./board"),a=r("./pgn"),s=r("./piece");e.toPosition=function(r){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=[];r.timeline>=0?e[0]=2*r.timeline:e[0]=2*-r.timeline-1;var n=r.turn;return t&&n++,e[1]=2*(n-1)+("white"===r.player?0:1),e[2]=r.rank-1,e[3]=r.file-1,e},e.fromPosition=function(r){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e={};return 0==r[0]?e.timeline=0:r[0]%2==0?e.timeline=Math.ceil(r[0]/2):e.timeline=-Math.ceil(r[0]/2),e.turn=Math.floor(r[1]/2)+1,t&&e.turn--,e.player=r[1]%2===0?"white":"black",e.coordinate=a.toSanCoord([r[2],r[3]]),e.rank=r[2]+1,e.file=r[3]+1,e},e.toMove=function(r){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=[];return e[0]=n.toPosition(r.start,t),e[1]=n.toPosition(r.end,t),null!==r.promotion&&(e[1][4]=s.fromChar(r.promotion,"white"===r.player?0:1)),null!=r.enPassant&&(e[2]=n.toPosition(r.enPassant,t)),null!=r.castling&&(e[2]=n.toPosition(r.castling.start,t),e[3]=n.toPosition(r.castling.end,t)),e},e.fromMove=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={promotion:null,enPassant:null,castling:null};if(a.start=n.fromPosition(t[0],e),a.end=n.fromPosition(t[1],e),a.player=t[0][1]%2==0?"white":"black",void 0!=t[1][4]&&2==t.length&&(a.promotion=s.toChar(t[1][4])),3==t.length&&(a.enPassant=n.fromPosition(t[2],e)),4==t.length){var i=t[3].slice();i[1]=i[1]+1,a.castling={start:n.fromPosition(t[2],e),end:n.fromPosition(t[3],e),realEnd:n.fromPosition(i,e)}}var c=0,l=0,h=0,u=0,f=o.copy(r);try{for(var v=0;v<f.length;v++)"undefined"!=typeof f[v]&&null!=f[v]&&(v%2==0?l=v:c=v);o.move(f,t);for(var d=0;d<f.length;d++)"undefined"!=typeof f[d]&&null!=f[d]&&(d%2==0?u=d:h=d)}catch(p){}var g=t[1].slice();return g[1]=g[1]+1,c!=h?g[0]=h:l!=u&&(g[0]=u),a.realEnd=n.fromPosition(g,e),a},e.toAction=function(r){var t,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[],a=i(r.moves);try{for(a.s();!(t=a.n()).done;){var s=t.value;o.push(n.toMove(s,e))}}catch(c){a.e(c)}finally{a.f()}return o},e.fromAction=function(r,t,e){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={};s.action=Math.floor(t/2)+1,s.player=t%2===0?"white":"black",s.moves=[];var c,l=o.copy(r),h=i(e);try{for(h.s();!(c=h.n()).done;){var u=c.value;s.moves.push(n.fromMove(l,u,a)),o.move(l,u)}}catch(f){h.e(f)}finally{h.f()}return s},e.toPiece=function(r){var t=s.fromChar(r.piece,"white"==r.player?0:1);return 0==r.hasMoved&&(t=-t),t},e.fromPiece=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=r[t[0]][t[1]][t[2]][t[3]],a={};return a.position=n.fromPosition(t,e),a.piece=s.toChar(o),a.player=Math.abs(o)%2===0?"white":"black",a.hasMoved=o>0,a},e.toTurn=function(r){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=[],o=0;o<r.height;o++){e.push([]);for(var a=0;a<r.width;a++)e[o][a]=0}var s,c=i(r.pieces);try{for(c.s();!(s=c.n()).done;){var l=s.value,h=n.toPiece(l),u=n.toPosition(l.position,t);e[u[2]][u[3]]=h}}catch(f){c.e(f)}finally{c.f()}return e},e.fromTurn=function(r,t,e){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=r[t][e],i={};i.turn=Math.floor(e/2)+1,o&&i.turn--,i.player=e%2==0?"white":"black",i.pieces=[],i.width=0,i.height=a.length;for(var s=0;s<a.length;s++)for(var c=0;c<a[s].length;c++)0!=a[s][c]&&(i.pieces.push(n.fromPiece(r,[t,e,s,c],o)),i.width=i.width<a[s].length?a[s].length:i.width);return i},e.toTimeline=function(r){var t,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[],a=0,s=i(r.turns);try{for(s.s();!(t=s.n()).done;){var c=t.value,l=c.turn;e&&l++;var h=2*(l-1)+("white"==c.player?0:1);a=a<h?h:a}}catch(p){s.e(p)}finally{s.f()}for(var u=0;u<a;u++)o[u]=null;var f,v=i(r.turns);try{for(v.s();!(f=v.n()).done;){var d=f.value,g=d.turn;e&&g++,o[2*(g-1)+("white"==d.player?0:1)]=n.toTurn(d,e)}}catch(p){v.e(p)}finally{v.f()}return o},e.fromTimeline=function(r,t,e){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};i.timeline=0==e?0:e%2==0?Math.ceil(e/2):-Math.ceil(e/2),i.player=e%2==0?"white":"black",i.turns=[],i.active=o.active(r).includes(e),i.present=o.present(r,t).includes(e);for(var s=r[e],c=0;c<s.length;c++)"undefined"!=typeof s[c]&&null!=s[c]&&i.turns.push(n.fromTurn(r,e,c,a));return i},e.toBoard=function(r){var t,e=r.timelines,o=[],a=!1,s=0,c=i(e);try{for(c.s();!(t=c.n()).done;){var l,h=t.value,u=i(h.turns);try{for(u.s();!(l=u.n()).done;)0==l.value.turn&&(a=!0)}catch(g){u.e(g)}finally{u.f()}var f=h.timeline<0?2*-h.timeline.timeline-1:2*h.timeline;s=s<f?f:s}}catch(g){c.e(g)}finally{c.f()}for(var v=0;v<s;v++)o[v]=null;for(var d=0;d<e.length;d++)o[e[d].timeline<0?2*-e[d].timeline-1:2*e[d].timeline]=n.toTimeline(r.timelines[d],a);return o},e.fromBoard=function(r,t){var e=o.isTurnZero(r),a={};a.action=Math.floor(t/2)+1,a.player=t%2===0?"white":"black",a.timelines=[];for(var s=0;s<r.length;s++)"undefined"!==typeof r[s]&&null!==r[s]&&a.timelines.push(n.fromTimeline(r,t,s,e));a.width=0,a.height=0;var c,l=i(a.timelines);try{for(l.s();!(c=l.n()).done;){var h,u=c.value,f=i(u.turns);try{for(f.s();!(h=f.n()).done;){var v=h.value;a.width<v.width&&(a.width=v.width),a.height<v.height&&(a.height=v.height)}}catch(d){f.e(d)}finally{f.f()}}}catch(d){l.e(d)}finally{l.f()}return a}},{"./board":5,"./pgn":14,"./piece":15}],14:[function(r,t,e){var n=this,o=r("./board"),a=r("./parse"),s=r("./piece"),c=r("./validate");e.toSanCoord=function(r){return String.fromCharCode(r[1]+97)+(r[0]+1)},e.fromSanCoord=function(r){var t=r.match(/^([a-h]?)(\d?)/);return[t[2].length>0?Number(t[2])-1:-1,t[1].length>0?t[1].charCodeAt(0)-97:-1]},e.ambiguousSan=function(r,t){var e,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=r[0],u=r[1],f=Math.abs(t[h[0]][h[1]][h[2]][h[3]]),v=t[u[0]][u[1]][u[2]][u[3]],d=s.length<=0?o.moves(t,a,!1,!1,l):s,g=!1,p=!1,y=!1,m="",w=i(d);try{for(w.s();!(e=w.n()).done;){var b=e.value;if(!(0==c.compareMove(r,b)||b.length>3)){var A=b[0],M=b[1];f==Math.abs(t[A[0]][A[1]][A[2]][A[3]])&&h[0]==A[0]&&h[1]==A[1]&&u[0]==M[0]&&u[1]==M[1]&&u[2]==M[2]&&u[3]==M[3]&&(h[2]==A[2]&&(p=!0),h[3]==A[3]&&(y=!0),g=!0)}}}catch(k){w.e(k)}finally{w.f()}return g&&(y?y&&!p?m+=n.toSanCoord([h[2],h[3]])[1]:y&&p&&(m+=n.toSanCoord([h[2],h[3]])):m+=n.toSanCoord([h[2],h[3]])[0]),0==Math.abs(v)&&3!=r.length||((1==Math.abs(f)||2==Math.abs(f)&&!g)&&(m+=n.toSanCoord([h[2],h[3]])[0]),m+="x"),m+=n.toSanCoord([u[2],u[3]])},e.fromMove=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=r[0],f=r[1],v=o.isTurnZero(t),d=o.isEvenTimeline(t),g=a.fromMove(t,r,v),p=t.length<=1,y=u[0]!==f[0],m=u[1]!==f[1],w="",b=4===r.length&&o.isNormalCastling(t),A=f.length>=5,M=y||m,k=!1,B=!1,C=null,P=null;if(M){var S=o.copy(t),T=null,E=null;o.move(S,r);for(var x=0;x<S.length;x++)Array.isArray(S[x])&&!Array.isArray(t[x])&&(B=!0,P=x%2==0?Math.ceil(x/2):-Math.ceil(x/2),T=x);for(var N=o.active(t),O=o.active(S),H=0;H<O.length;H++)N.includes(O[H])||O[H]==T||(E=O[H]);null!=E&&S[E].length+1<S[T].length&&(C=Math.floor((S[E].length+1)/2)),O.includes(T)&&(k=!0)}var j="(".concat(g.start.timeline,"T").concat(g.start.turn,")");d&&(j=g.start.timeline<-1?"(".concat(g.start.timeline+1,"T").concat(g.start.turn,")"):-1==g.start.timeline?"(-0T".concat(g.start.turn,")"):1==g.start.timeline?"(+0T".concat(g.start.turn,")"):"(".concat(g.start.timeline-1,"T").concat(g.start.turn,")"));var F="(".concat(g.end.timeline,"T").concat(g.end.turn,")");d&&(F=g.end.timeline<-1?"(".concat(g.end.timeline+1,"T").concat(g.end.turn,")"):-1===g.end.timeline?"(-0T".concat(g.end.turn,")"):1===g.end.timeline?"(+0T".concat(g.end.turn,")"):"(".concat(g.end.timeline-1,"T").concat(g.end.turn,")"));var D=t[u[0]][u[1]][u[2]][u[3]],L=t[f[0]][f[1]][f[2]][f[3]],_=0!==Math.abs(L),I=s.toChar(D,M),Z="";return A&&(Z=s.toChar(f[4])),M?(w+=j,w+=I,w+=n.toSanCoord([u[2],u[3]]),w+=B?">>":">",w+=_?"x":"",w+=F,w+=n.toSanCoord([f[2],f[3]])):(!h&&p||(w+=j),b?(w+="O-O",Math.abs(r[2][3]-r[3][3])>2&&(w+="-O")):(w+=I,w+=n.ambiguousSan(r,t,e,[],null))),A&&(w+="=".concat(Z)),w+=i,w+=k?"~":"",c&&null!==C&&(w+=" (~T".concat(C,")")),l&&null!=P&&(w+=" (>L".concat(P,")")),w},e.toMove=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=[[0,0,-1,-1],[0,0,-1,-1]],l=r,h=(r=(r=(r=(r=(r=(r=r.replace(/\r\n/g,"\n")).replace(/\{[^\{\}]*\}/g,"")).replace(/;[^;\n]*\n/g,"\n")).replace(/\s/g,"")).replace(/\(~T\-?\d*\)/g,"")).replace(/\(>L\-?\d*\)/g,"")).includes(">"),u=o.isTurnZero(t),f=o.isEvenTimeline(t),v=e%2==0?2:1;if(h){try{var d=r.match(/^\(L?\-?\+?\d+T\-?\+?\d+\)/)[0];r=r.replace(/^\(L?\-?\+?\d+T\-?\+?\d+\)/,"");var g=(d=d.replace(/L/g,"")).match(/\((\-?\+?\d*)T(\-?\+?\d*)\)/),p=Number(g[1]);f&&("-0"==g[1]?p=-1:"+0"==g[1]?p=1:p<0?p--:p>0&&p++);var y=Number(g[2]);c[0][0]=2*Math.abs(p)+(p<0?-1:0),c[0][1]=2*(y-1)+(e%2===0?0:1),u&&(c[0][1]+=2)}catch(I){throw new Error("Source super-physical coordinates missing or incorrect!")}var m=r.match(/^[A-Z]+/);null!=m&&(v=s.fromChar(m[0],e)),r=r.replace(/^[A-Z]+/,"");var w=n.fromSanCoord(r.match(/^[a-h]\d/)[0]);r=r.replace(/^[a-h]\d/,""),c[0][2]=w[0],c[0][3]=w[1],r=(r=r.replace(/>/g,"")).replace(/^x/,"");try{var b=r.match(/^\(L?\-?\+?\d+T\-?\+?\d+\)/)[0];r=r.replace(/^\(L?\-?\+?\d+T\-?\+?\d+\)/,"");var A=(b=b.replace(/L/g,"")).match(/\((\-?\+?\d*)T(\-?\+?\d*)\)/),M=Number(A[1]);f&&("-0"==A[1]?M=-1:"+0"==A[1]?M=1:M<0?M--:M>0&&M++);var k=Number(A[2]);c[1][0]=2*Math.abs(M)+(M<0?-1:0),c[1][1]=2*(k-1)+(e%2==0?0:1),u&&(c[1][1]+=2)}catch(I){throw new Error("Destination super-physical coordinates missing or incorrect!")}var B=n.fromSanCoord(r.match(/^[a-h]\d/)[0]);c[1][2]=B[0],c[1][3]=B[1]}else{try{var C=r.match(/^\(L?\-?\+?\d+T\-?\+?\d+\)/)[0].replace(/L/g,"").match(/\((\-?\+?\d*)T(\-?\+?\d*)\)/);r=r.replace(/^\(L?\-?\+?\d+T\-?\+?\d+\)/,"");var P=Number(C[1]);f&&("-0"==C[1]?P=-1:"+0"==C[1]?P=1:P<0?P--:P>0&&P++);var S=Number(C[2]);c[0][0]=2*Math.abs(P)+(P<0?-1:0),c[0][1]=2*(S-1)+(e%2===0?0:1),u&&(c[0][1]+=2)}catch(I){t.length>=1&&t[0].length>0&&(c[0][1]=t[0].length-1)}if(c[1][0]=c[0][0],c[1][1]=c[0][1],r.includes("O-O"))e%2!==0?(c[0][2]=7,c[1][2]=7):(c[0][2]=0,c[1][2]=0),c[0][3]=4,r.includes("O-O-O")?c[1][3]=2:c[1][3]=6;else{var T=r.match(/^[A-Z]+/);null!==T&&(v=s.fromChar(T[0],e));var E=(r=r.replace(/^[A-Z]+/,"")).match(/^([a-h]?\d?)x?([a-h]\d)/),x=n.fromSanCoord(E[1]),N=n.fromSanCoord(E[2]);r=r.replace(/^[a-h]?\d?x?[a-h]\d/,""),c[0][2]=x[0],c[0][3]=x[1],c[1][2]=N[0],c[1][3]=N[1]}}var O=r.match(/^=([A-Z])+/);null!=O&&(r=r.slice(O[0].length),c[1][4]=s.fromChar(O[1],e));var H=a;H.length<=0&&(H=o.moves(t,e,!1,!1,!1,i));for(var j=[],F=0;F<H.length;F++)if(c[0][0]==H[F][0][0]&&c[0][1]==H[F][0][1]&&c[1][0]==H[F][1][0]&&c[1][1]==H[F][1][1]&&c[1][2]==H[F][1][2]&&c[1][3]==H[F][1][3]&&(void 0==c[1][4]||Math.abs(c[1][4])==Math.abs(H[F][1][4]))){if(c[0][2]==H[F][0][2]&&c[0][3]==H[F][0][3])return H[F];v==Math.abs(t[H[F][0][0]][H[F][0][1]][H[F][0][2]][H[F][0][3]])&&j.push(H[F])}for(var D=c[0][2]<0,L=c[0][3]<0,_=0;_<j.length;_++){if(D&&L)return j[_];if(!D&&L&&j[_][0][2]==c[0][2])return j[_];if(D&&!L&&j[_][0][3]==c[0][3])return j[_]}if(H.length>0)throw new Error("No valid move found! Error occurred with this move: "+l);return D&&(c[0][2]=0),L&&(c[0][3]=0),c},e.fromAction=function(r){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l="",h=o.copy(t),u=0;u<r.length;u++)l+=n.fromMove(r[u],h,e,u+1===r.length?a:"",i,s,c),u+1<r.length&&(l+=" "),o.move(h,r[u]);return l},e.toAction=function(r){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=""+r,s=(i=(i=(i=(i=(i=(i=i.replace(/\r\n/g,"\n")).replace(/\{[^\{\}]*\}/g,"")).replace(/;[^;\n]*\n/g,"\n")).replace(/\(~T\-?\d*\)/g,"")).replace(/\(>L\-?\d*\)/g,"")).replace(/\s+/g," ")).split(" "),c=[],l=o.copy(t),h=0;h<s.length;h++)if(!(s[h].length<=0)){var u=n.toMove(s[h],l,e,[],a);c.push(u),o.move(l,u)}return c},e.fromActionHistory=function(r){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\n",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=o.copy(t),u=e,f="",v=0;v<r.length;v++){f+=u%2==0?Math.floor(u/2)+1+". ":" / ",f+=n.fromAction(r[v],h,u,i[v]?i[v]:"",s,c,l),u%2!==0&&v+1<r.length&&(f+=a);for(var d=0;d<r[v].length;d++)o.move(h,r[v][d]);u++}return f},e.toActionHistory=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=o.copy(t),s=e,c=""+r;c=(c=(c=(c=c.replace(/\r\n/g,"\n")).replace(/\[[^\[\]]*\]/g,"")).replace(/\{[^\{\}]*\}/g,"")).replace(/;[^;\n]*\n/g,"\n");for(var l=[],h=[],u=!1;!u;){var f=c.match(/\d+\.\s*/i);if(null==f)return"";var v=(c=c.substring(f.index+f[0].length)).match(/\d+\.\s*/i);null!=v?(l.push(c.substring(0,v.index-1).split("/")),c=c.substring(v.index)):(l.push(c.split("/")),u=!0)}l=l.flat(1);for(var d=0;d<l.length;d++)if(l[d].trim()){var g=n.toAction(l[d],i,s,a);h.push(g);for(var p=0;p<g.length;p++)o.move(i,g[p]);s++}return h}},{"./board":5,"./parse":13,"./piece":15,"./validate":18}],15:[function(r,t,e){var o=this,a=r("./board");e.toChar=function(r){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=Math.abs(r);if(t&&(1===e||2===e))return"P";switch(e){case 3:case 4:return"B";case 5:case 6:return"N";case 7:case 8:return"R";case 9:case 10:return"Q";case 11:case 12:return"K";case 13:case 14:return"S";case 15:case 16:return"W";case 17:case 18:return"C";case 19:case 20:return"Y";case 21:case 22:return"U";case 23:case 24:return"D";default:return""}},e.fromChar=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(r){case"P":return t%2===0?2:1;case"B":return t%2===0?4:3;case"N":return t%2===0?6:5;case"R":return t%2===0?8:7;case"Q":return t%2===0?10:9;case"K":return t%2===0?12:11;case"S":return t%2===0?14:13;case"W":case"BR":return t%2===0?16:15;case"C":case"CK":return t%2===0?18:17;case"Y":case"RQ":return t%2===0?20:19;case"U":return t%2===0?22:21;case"D":return t%2===0?24:23;default:return t%2===0?2:1}},e.movePos=function(r){switch(Math.abs(r)){case 5:case 6:return[[0,0,1,2],[0,0,1,-2],[0,0,-1,2],[0,0,-1,-2],[0,0,2,1],[0,0,2,-1],[0,0,-2,1],[0,0,-2,-1],[0,1,0,2],[0,1,0,-2],[0,-1,0,2],[0,-1,0,-2],[0,2,0,1],[0,2,0,-1],[0,-2,0,1],[0,-2,0,-1],[0,1,2,0],[0,1,-2,0],[0,-1,2,0],[0,-1,-2,0],[0,2,1,0],[0,2,-1,0],[0,-2,1,0],[0,-2,-1,0],[1,0,0,2],[1,0,0,-2],[-1,0,0,2],[-1,0,0,-2],[2,0,0,1],[2,0,0,-1],[-2,0,0,1],[-2,0,0,-1],[1,0,2,0],[1,0,-2,0],[-1,0,2,0],[-1,0,-2,0],[2,0,1,0],[2,0,-1,0],[-2,0,1,0],[-2,0,-1,0],[1,2,0,0],[1,-2,0,0],[-1,2,0,0],[-1,-2,0,0],[2,1,0,0],[2,-1,0,0],[-2,1,0,0],[-2,-1,0,0]];case 11:case 12:case 17:case 18:return[[0,0,0,1],[0,0,0,-1],[0,0,1,0],[0,0,-1,0],[0,0,1,1],[0,0,1,-1],[0,0,-1,1],[0,0,-1,-1],[0,1,0,0],[0,-1,0,0],[0,1,0,1],[0,1,0,-1],[0,-1,0,1],[0,-1,0,-1],[0,1,1,0],[0,1,-1,0],[0,-1,1,0],[0,-1,-1,0],[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,0,0],[-1,0,0,0],[1,0,0,1],[1,0,0,-1],[-1,0,0,1],[-1,0,0,-1],[1,0,1,0],[1,0,-1,0],[-1,0,1,0],[-1,0,-1,0],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,0],[1,-1,0,0],[-1,1,0,0],[-1,-1,0,0],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0],[1,1,1,1],[1,1,1,-1],[1,1,-1,1],[1,1,-1,-1],[1,-1,1,1],[1,-1,1,-1],[1,-1,-1,1],[1,-1,-1,-1],[-1,1,1,1],[-1,1,1,-1],[-1,1,-1,1],[-1,1,-1,-1],[-1,-1,1,1],[-1,-1,1,-1],[-1,-1,-1,1],[-1,-1,-1,-1]];default:return[]}},e.moveVecs=function(r){switch(Math.abs(r)){case 3:case 4:return[[0,0,1,1],[0,0,1,-1],[0,0,-1,1],[0,0,-1,-1],[0,1,0,1],[0,1,0,-1],[0,-1,0,1],[0,-1,0,-1],[0,1,1,0],[0,1,-1,0],[0,-1,1,0],[0,-1,-1,0],[1,0,0,1],[1,0,0,-1],[-1,0,0,1],[-1,0,0,-1],[1,0,1,0],[1,0,-1,0],[-1,0,1,0],[-1,0,-1,0],[1,1,0,0],[1,-1,0,0],[-1,1,0,0],[-1,-1,0,0]];case 7:case 8:return[[0,0,0,1],[0,0,0,-1],[0,0,1,0],[0,0,-1,0],[0,1,0,0],[0,-1,0,0],[1,0,0,0],[-1,0,0,0]];case 9:case 10:case 19:case 20:return[[0,0,0,1],[0,0,0,-1],[0,0,1,0],[0,0,-1,0],[0,0,1,1],[0,0,-1,1],[0,0,1,-1],[0,0,-1,-1],[0,1,0,0],[0,-1,0,0],[0,1,0,1],[0,1,0,-1],[0,-1,0,1],[0,-1,0,-1],[0,1,1,0],[0,1,-1,0],[0,-1,1,0],[0,-1,-1,0],[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,0,0],[-1,0,0,0],[1,0,0,1],[1,0,0,-1],[-1,0,0,1],[-1,0,0,-1],[1,0,1,0],[1,0,-1,0],[-1,0,1,0],[-1,0,-1,0],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,0],[1,-1,0,0],[-1,1,0,0],[-1,-1,0,0],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0],[1,1,1,1],[1,1,1,-1],[1,1,-1,1],[1,1,-1,-1],[1,-1,1,1],[1,-1,1,-1],[1,-1,-1,1],[1,-1,-1,-1],[-1,1,1,1],[-1,1,1,-1],[-1,1,-1,1],[-1,1,-1,-1],[-1,-1,1,1],[-1,-1,1,-1],[-1,-1,-1,1],[-1,-1,-1,-1]];case 13:case 14:return[[0,0,0,1],[0,0,0,-1],[0,0,1,0],[0,0,-1,0],[0,0,1,1],[0,0,1,-1],[0,0,-1,1],[0,0,-1,-1],[0,1,0,0],[0,-1,0,0],[0,1,0,1],[0,1,0,-1],[0,-1,0,1],[0,-1,0,-1],[0,1,1,0],[0,1,-1,0],[0,-1,1,0],[0,-1,-1,0],[1,0,0,0],[-1,0,0,0],[1,0,0,1],[1,0,0,-1],[-1,0,0,1],[-1,0,0,-1],[1,0,1,0],[1,0,-1,0],[-1,0,1,0],[-1,0,-1,0],[1,1,0,0],[1,-1,0,0],[-1,1,0,0],[-1,-1,0,0]];case 21:case 22:return[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]];case 23:case 24:return[[1,1,1,1],[1,1,1,-1],[1,1,-1,1],[1,1,-1,-1],[1,-1,1,1],[1,-1,1,-1],[1,-1,-1,1],[1,-1,-1,-1],[-1,1,1,1],[-1,1,1,-1],[-1,1,-1,1],[-1,1,-1,-1],[-1,-1,1,1],[-1,-1,1,-1],[-1,-1,-1,1],[-1,-1,-1,-1]];default:return[]}},e.availablePromotionPieces=function(r){for(var t=[],e=0;r&&e<r.length;e++)for(var n=0;r[e]&&n<r[e].length;n++)for(var o=0;r[e][n]&&o<r[e][n].length;o++)for(var a=0;r[e][n][o]&&a<r[e][n][o].length;a++){var i=Math.abs(r[e][n][o][a]);if((i>=3&&i<=10||13==i||14==i||17==i||18==i)&&!t.includes(i)){t.push(i);var s=i%2===0?i-1:i+1;t.includes(s)||t.push(s)}}return t.sort((function(r,t){return t-r}))},e.timelineMove=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=r%2==0?r+2*t:r-2*t;return n=!e&&n<0?-1*n-1:n,n=e&&n<=0?-1*n+1:n},e.moves=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=[];if(!a.positionExists(r,t))return c;var l=t[0],h=t[1],u=t[2],f=t[3],v=r[l][h][u][f];if(0===v)return c;var d=Math.abs(v),g=d%2,p=a.isEvenTimeline(r);if(1===d||2===d||15===d||16===d){var y=r[l][h],m=1===g?-1:1,w=1===g?0:y.length-1,b=u+m;if(b>=0&&b<y.length&&f>=0&&f<y[b].length&&0===y[b][f]&&(c=o.promotionPiece(t,r,b,f,s,w,g,c),v<0)){var A=b+m;A>=0&&A<y.length&&f>=0&&f<y[b].length&&0===y[A][f]&&(c=o.promotionPiece(t,r,A,f,s,w,g,c))}if(c=o.enPassantMovement(r,t,w,s,m,y,g,b,f+1,c),c=o.enPassantMovement(r,t,w,s,m,y,g,b,f-1,c),!e){var M=[o.timelineMove(l,-m,p),h,u,f];if(a.positionExists(r,M)&&0===r[M[0]][h][u][f]&&(c.push([t,M]),v<0)){var k=[o.timelineMove(l,2*-m,p),h,u,f];a.positionExists(r,k)&&0===r[k[0]][h][u][f]&&c.push([t,k])}if(M=[o.timelineMove(l,-m,p),h+2,u,f],c=o.opponentTimelineCapture(r,t,M,g,c),M=[o.timelineMove(l,-m,p),h-2,u,f],c=o.opponentTimelineCapture(r,t,M,g,c),15===d||16===d)for(var B=0,C=[[-m,0,0,1],[-m,0,0,-1],[-m,0,m,0],[0,-1,m,0]];B<C.length;B++){var P=n(C[B],4),S=P[0],T=P[1],E=P[2],x=P[3];if(g?(currMove=[t.slice(),[l,h+2*T,u+E,f+x]],currMove[1][0]=o.timelineMove(currMove[1][0],S,p)):(currMove=[t.slice(),[t[0],t[1]+2*T,t[2]+E,t[3]+x]],currMove[1][0]=o.timelineMove(currMove[1][0],S,p)),a.positionExists(r,currMove[1])){var N=r[currMove[1][0]][currMove[1][1]][currMove[1][2]][currMove[1][3]];if(0!==N&&Math.abs(N)%2!==g)if(currMove[1][2]===w){s=!s||s.length<=0?o.availablePromotionPieces(r):s;var O,H=i(s);try{for(H.s();!(O=H.n()).done;){var j=O.value;j%2===g&&(currMove[1][4]=j,c.push([currMove[0].slice(),currMove[1].slice()]))}}catch(yr){H.e(yr)}finally{H.f()}}else c.push([currMove[0].slice(),currMove[1].slice()])}}}}else{var F=r[l][h],D=[0,0,4,4,8,8,4,4,8,8,8,8,8,8,0,0,8,8,8,8,0,0,0,0],L=o.movePos(v);if(0!==L.length){for(var _=D[Math.abs(v)-1],I=0;I<_;I++){var Z=u+L[I][2],R=f+L[I][3];if(!(Z<0||Z>=F.length||R<0||R>=F[Z].length)){var U=F[Z][R];0!==U&&Math.abs(U)%2===g||c.push([t,[l,h,Z,R]])}}if(!e)for(var V=_;V<L.length;V++){var W=[o.timelineMove(l,L[V][0],p),h+2*L[V][1],u+L[V][2],f+L[V][3]];if(a.positionExists(r,W)){var J=r[W[0]][W[1]][W[2]][W[3]];0!==J&&Math.abs(J)%2===g||c.push([t,W])}}}var Q=o.moveVecs(v);if(0!==Q.length){for(var z=D[d-1],K=0;K<z;K++)for(var q=Q[K][2],Y=Q[K][3],$=u+q,G=f+Y;$>=0&&$<F.length&&G>=0&&G<F[$].length;){var X=F[$][G];if(0!==X){Math.abs(X)%2!==g&&c.push([t,[l,h,$,G]]);break}c.push([t,[l,h,$,G]]),$+=q,G+=Y}if(!e)for(var rr=z;rr<Q.length;rr++)for(var tr=Q[rr][0],er=2*Q[rr][1],nr=Q[rr][2],or=Q[rr][3],ar=[o.timelineMove(l,tr,p),h+er,u+nr,f+or];a.positionExists(r,ar);){var ir=r[ar[0]][ar[1]][ar[2]][ar[3]];if(0!==ir){Math.abs(ir)%2!==g&&c.push([t,ar]);break}c.push([t,ar.slice()]),ar[0]=o.timelineMove(ar[0],tr,p),ar[1]+=er,ar[2]+=nr,ar[3]+=or}}if(-11===v||-12===v){var sr=F[u],cr=void 0,lr=f+1;if(lr>=0&&lr<sr.length&&0===sr[lr]&&++lr>=0&&lr<sr.length&&0===sr[lr])for(lr++;lr>=0&&lr<sr.length;){var hr=sr[lr];if(0!==hr){if(hr-g===-8){var ur=[l,h,u,f+1],fr=[l,h,u,f+2];(cr=!a.positionIsAttacked(r,t,g))&&!a.positionIsAttacked(r,ur,g)&&!a.positionIsAttacked(r,fr,g)&&c.push([t,fr,[l,h,u,lr],ur])}break}lr++}if((lr=f-1)>=0&&lr<sr.length&&0===sr[lr]&&--lr>=0&&lr<sr.length&&0===sr[lr])for(lr--;lr>=0&&lr<sr.length;){var vr=sr[lr];if(0!==vr){if(vr-g===-8){var dr=[l,h,u,f-1],gr=[l,h,u,f-2],pr=!a.positionIsAttacked(r,dr,g)&&!a.positionIsAttacked(r,gr,g);void 0!==cr?cr&&pr&&c.push([t,gr,[l,h,u,lr],dr]):!a.positionIsAttacked(r,t,g)&&pr&&c.push([t,gr,[l,h,u,lr],dr])}break}lr--}}}return c},e.promotionPiece=function(r,t,e,n,a,i,s,c){var l=r[0],h=r[1];if(e===i){(!a||a.length<=0)&&(a=o.availablePromotionPieces(t));for(var u=0;u<a.length;u++)a[u]%2===s&&c.push([r,[l,h,e,n,a[u]]])}else c.push([r,[l,h,e,n]]);return c},e.enPassant=function(r,t,e,n,o,i,s,c){var l=t[0],h=t[1],u=t[2];if(s<0||s>=e[u].length)return c;var f=e[u][s]-n;if(1!==f&&15!==f)return c;var v=i+o;if(v>=0&&v<e.length&&s>=0&&s<e[v].length){if(0!==(f=e[v][s]))return c;if(a.positionExists(r,[l,h-2,v,s])&&a.positionExists(r,[l,h-2,u,s])){if(0!==(f=r[l][h-2][u][s]))return c;-1!==(f=r[l][h-2][v][s]+n)&&-15!==f||c.push([t,[l,h,i,s],[l,h,u,s]])}}return c},e.enPassantMovement=function(r,t,e,n,a,i,s,c,l,h){if(c<0&&c>=i.length||l<0||l>=i[c].length)return h;var u=i[c][l];return 0!==u&&Math.abs(u)%2!==s&&(h=o.promotionPiece(t,r,c,l,n,e,s,h)),h=o.enPassant(r,t,i,s,a,c,l,h)},e.opponentTimelineCapture=function(r,t,e,n,o){var i=t[2],s=t[3];if(a.positionExists(r,e)){var c=r[e[0]][e[1]][i][s];0!==c&&Math.abs(c)%2!==n&&o.push([t,e])}return o}},{"./board":5}],16:[function(r,t,e){var n=this;e.turnArray=function(r,t,e){for(var n=[],o=0;o<10;o++){n[o]=[];for(var a=0;a<10;a++)n[o][a]=0===o?0===a?"\u2554":9===a?"\u2557":"\u2550":9===o?0===a?"\u255a":9===a?"\u255d":"\u2550":0===a||9===a?"\u2551":"."}if(r&&r[t]&&r[t][e])for(o=0;o<r[t][e].length;o++)if(r[t][e][o])for(a=0;a<r[t][e][o].length;a++){var i=Math.abs(r[t][e][o][a]);1===i?n[8-o][a+1]="p":3===i?n[8-o][a+1]="b":5===i?n[8-o][a+1]="n":7===i?n[8-o][a+1]="r":9===i?n[8-o][a+1]="q":11===i?n[8-o][a+1]="k":13===i?n[8-o][a+1]="s":2===i?n[8-o][a+1]="P":4===i?n[8-o][a+1]="B":6===i?n[8-o][a+1]="N":8===i?n[8-o][a+1]="R":10===i?n[8-o][a+1]="Q":12===i?n[8-o][a+1]="K":14===i&&(n[8-o][a+1]="S")}for(var s=t+","+e,c=1;c<10;c++)c-1<s.length&&(n[0][c]=s.charAt(c-1));for(o=1;o<9;o++)for(a=1;a<9;a++)(o+a)%2===0&&(n[o][a]=n[o][a]);return n},e.blankTurnArray=function(){for(var r=[],t=0;t<10;t++){r[t]=[];for(var e=0;e<10;e++)r[t][e]=" "}return r},e.boardArray=function(r){for(var t=[],e=0,o=r.length-1;r&&o>=0;o--)if(o%2!==0&&(t[Math.floor((r.length-o-1)/2)]=[],e++),Array.isArray(r[o])&&o%2!==0)for(var a=0;a<r[o].length;a++)Array.isArray(r[o][a])?t[Math.floor((r.length-o-1)/2)][a]=n.turnArray(r,o,a):t[Math.floor((r.length-o-1)/2)][a]=n.blankTurnArray(r,o,a);for(o=0;r&&o<r.length;o++)if(Array.isArray(r[o])&&o%2===0)for(t[o/2+e]=[],a=0;a<r[o].length;a++)Array.isArray(r[o][a])?t[o/2+e][a]=n.turnArray(r,o,a):t[o/2+e][a]=n.blankTurnArray(r,o,a);return t},e.printBoard=function(r){for(var t="",e=n.boardArray(r),o=0;e&&o<e.length;o++)for(var a=0;a<10;a++){for(var i=0;e[o]&&i<e[o].length;i++)for(var s=0;s<10;s++)t+=e[o][i][a][s];t+="\n"}return t}},{}],17:[function(r,t,e){e.copy=function(r,t,e){var n=[];if(r&&r[t]&&r[t][e]){var o,a=i(r[t][e]);try{for(a.s();!(o=a.n()).done;){var s=o.value;s&&n.push(s.slice())}}catch(c){a.e(c)}finally{a.f()}}return n.length<=0?null:n}},{}],18:[function(r,t,e){var n=this,o=r("./board");e.move=function(r,t,e){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;a=a.length<=0?o.moves(r,t,!1,!1,!1,i):a;for(var s=0;s<a.length;s++)if(0==n.compareMove(a[s],e))return!0;return!1},e.action=function(r,t,e){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",c=o.copy(r),l=i(e);try{for(l.s();!(a=l.n()).done;){var h=a.value;if(!n.move(c,t,h,s))return!1;o.move(c,h)}}catch(u){l.e(u)}finally{l.f()}return!(o.present(c,t).length>0)},e.notation=function(r){var t=r.match(/^(\d+[bw]\.\s)\d+([\-\+]\d+)?:[PBNRQK]?[a-h][1-8]((<([\-\+]\d+)?>)+\d*([\-\+]\d+)?)?:x?[PBNRQ]?[a-h][1-8](e\.p\.)?[\=\+\#]?/),e=r.match(/^(\d+[bw]\.\s)\d+([\-\+]\d+)?:0\-0(\-0)?[\=\+\#]?/);return(null!=t||null!=e)&&!(null!=t&&t[0]!=r||null!=e&&e[0]!=r)},e.compareMove=function(r,t){if(!Array.isArray(r)&&Array.isArray(t))return 1;if(!Array.isArray(t))return-1;if(r.length!=t.length)return r.length-t.length;for(var e=0;e<r.length;e++)for(var n=0;n<r[e].length;n++){if(r[e].length!=t[e].length)return r[e].length-t[e].length;if(r[e][n]!=t[e][n])return void 0==r[e][n]?-1:void 0==t[e][n]?1:r[e][n]-t[e][n]}return 0}},{"./board":5}]},{},[10])(10)}()}).call(this,e(3))},function(r,t,e){"use strict";e.r(t),e.d(t,"extractHighlightNotation",(function(){return a}));var n=e(1),o=e.n(n),a=function(r,t,e){try{var n=new o.a;n.skipDetection=!0,n.import(e);var a=n.hash.slice();if(n.import(t),a!==n.hash){var i=n.copy();i.reset();for(var s=[],c=0;c<r.length;c++)s.push(r[c].includes("[")?r[c]:r[c].split(" "));s=s.flat();for(c=0;c<s.length;c++){for(var l="",h=0;h<=c;h++)l+=s[h]+(s[h].includes("[")?"\n":" ");try{if(i.import(l),i.hash===a)return s[c]}catch(u){}}}}catch(u){}return null};addEventListener("message",(function(r){var e,n=r.data,o=n.type,a=n.method,i=n.id,s=n.params;"RPC"===o&&a&&((e=t[a])?Promise.resolve().then((function(){return e.apply(t,s)})):Promise.reject("No such method")).then((function(r){postMessage({type:"RPC",id:i,result:r})})).catch((function(r){var t={message:r};r.stack&&(t.message=r.message,t.stack=r.stack,t.name=r.name),postMessage({type:"RPC",id:i,error:t})}))})),postMessage({type:"RPC",method:"ready"})},function(r,t){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(n){"object"===typeof window&&(e=window)}r.exports=e},function(r,t,e){var n=e(5),o=e(6),a=e(0),i=e(8);r.exports=function(r,t){return n(r)||o(r,t)||a(r,t)||i()}},function(r,t){r.exports=function(r){if(Array.isArray(r))return r}},function(r,t){r.exports=function(r,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(r)){var e=[],n=!0,o=!1,a=void 0;try{for(var i,s=r[Symbol.iterator]();!(n=(i=s.next()).done)&&(e.push(i.value),!t||e.length!==t);n=!0);}catch(c){o=!0,a=c}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return e}}},function(r,t){r.exports=function(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}},function(r,t){r.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(r,t){r.exports=function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}},function(r,t){function e(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}r.exports=function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}},function(r,t,e){var n=e(0);r.exports=function(r,t){var e;if("undefined"===typeof Symbol||null==r[Symbol.iterator]){if(Array.isArray(r)||(e=n(r))||t&&r&&"number"===typeof r.length){e&&(r=e);var o=0,a=function(){};return{s:a,n:function(){return o>=r.length?{done:!0}:{done:!1,value:r[o++]}},e:function(r){throw r},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){e=r[Symbol.iterator]()},n:function(){var r=e.next();return s=r.done,r},e:function(r){c=!0,i=r},f:function(){try{s||null==e.return||e.return()}finally{if(c)throw i}}}}}]);
//# sourceMappingURL=5c9851a4a47269ff3022.worker.js.map